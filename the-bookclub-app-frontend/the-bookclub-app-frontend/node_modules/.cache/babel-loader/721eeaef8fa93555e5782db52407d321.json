{"ast":null,"code":"import _toConsumableArray from\"/Users/winndie/github/the-bookclub/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/winndie/github/the-bookclub/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useState}from'react';import{useHistory}from\"react-router-dom\";import $ from'jquery';import Button from'react-bootstrap/Button';import Dropdown from'react-bootstrap/Dropdown';import'./BookList.css';import Book from'../Book/Book';var element=new Map();element.set(0,{key:'stocks',header:{label:'Books available to request',className:'text-center'},operation:{label:null,className:'row g-3 align-items-center'}});element.set(1,{key:'stocks',header:{label:'Books available to donate',className:'text-center'},operation:{label:null,className:'row g-3 align-items-center'}});element.set(2,{key:'cart.request',header:{label:'You\\'ve requested the following books',className:'text-center'},operation:{label:null,className:'hide'}});element.set(3,{key:'cart.donate',header:{label:'You\\'ve donated the following books',className:'text-center'},operation:{label:null,className:'hide'}});function BookList(_ref){var mode=_ref.mode;var history=useHistory();var getInitialStock=function getInitialStock(){if(sessionStorage.getItem(element.get(mode).key)!=null)return JSON.parse(sessionStorage.getItem(element.get(mode).key));if(mode<2){$.ajax({url:'https://yrtt-readers.github.io/the-bookclub/assets/data/stocks.json',async:false,dataType:'json',success:function success(data){try{sessionStorage.setItem(element.get(mode).key,JSON.stringify(data));}catch(e){console.log(e);}}});return JSON.parse(sessionStorage.getItem(element.get(mode).key));}};var _useState=useState(getInitialStock),_useState2=_slicedToArray(_useState,2),stocks=_useState2[0],setStocks=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),sortType=_useState4[0],setSortType=_useState4[1];var _useState5=useState(_toConsumableArray(new Set(stocks.map(function(v){return v.isbn;})))),_useState6=_slicedToArray(_useState5,2),bookList=_useState6[0],setBookList=_useState6[1];if(stocks==null)element.get(mode).header.className='hide';function onClickListener(e){if(e.target.className==='btn btn-primary checkout')history.push('/checkout');}var sortedList=function sortedList(key){var sortList=[];bookList.forEach(function(v){sortList.push([v,document.getElementById(v+'.'+key).innerText// JSON.parse(sessionStorage.getItem('book.'+v))[key]\n]);});return _toConsumableArray(new Set(sortList.sort(function(a,b){return a[1].localeCompare(b[1]);})// .sort((a,b)=> a[1] - b[1])\n.map(function(v){return v[0];})));};function onSortListener(e){setSortType(e);switch(sortType){case'title-AZ':setBookList(sortedList(\"book_name\"));break;case'title-ZA':setBookList(sortedList(\"book_name\").reverse());break;case'author-AZ':setBookList(sortedList(\"book_author\"));break;case'author-ZA':setBookList(sortedList(\"book_author\").reverse());break;}}return/*#__PURE__*/_jsxs(\"section\",{className:\"container container-margin\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row g-3\",children:/*#__PURE__*/_jsx(\"h1\",{className:element.get(mode).header.className,children:element.get(mode).header.label})}),/*#__PURE__*/_jsxs(\"div\",{className:element.get(mode).operation.className,children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary checkout\",onClick:onClickListener,children:\"Checkout\"}),/*#__PURE__*/_jsxs(Dropdown,{className:\"col-auto\",onMouseOut:onSortListener,onSelect:setSortType,children:[/*#__PURE__*/_jsx(Dropdown.Toggle,{variant:\"primary\",id:\"dropdown-basic-button\",children:\"Sort by\"}),/*#__PURE__*/_jsxs(Dropdown.Menu,{children:[/*#__PURE__*/_jsx(Dropdown.Item,{eventKey:\"title-AZ\",children:\"Title A-Z\"}),/*#__PURE__*/_jsx(Dropdown.Item,{eventKey:\"title-ZA\",children:\"Title Z-A\"}),/*#__PURE__*/_jsx(Dropdown.Item,{eventKey:\"author-AZ\",children:\"Author A-Z\"}),/*#__PURE__*/_jsx(Dropdown.Item,{eventKey:\"author-ZA\",children:\"Author Z-A\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-auto\",children:/*#__PURE__*/_jsx(\"label\",{htmlFor:\"inputSearch\",className:\"col-form-label\",children:\"Search book\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-auto\",children:/*#__PURE__*/_jsx(\"input\",{type:\"input\",id:\"inputSearch\",className:\"form-control\",\"aria-describedby\":\"searchHelpInline\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-auto\",children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",children:\"Search\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"row booklist\",children:bookList.map(function(v){return/*#__PURE__*/_jsx(Book,{mode:mode,isbn:v,stocks:stocks.filter(function(stock){return stock.isbn===v;}),setStocks:setStocks},v);})})]});}export default BookList;","map":{"version":3,"sources":["/Users/winndie/github/the-bookclub/src/components/BookList/BookList.js"],"names":["React","useState","useHistory","$","Button","Dropdown","Book","element","Map","set","key","header","label","className","operation","BookList","mode","history","getInitialStock","sessionStorage","getItem","get","JSON","parse","ajax","url","async","dataType","success","data","setItem","stringify","e","console","log","stocks","setStocks","sortType","setSortType","Set","map","v","isbn","bookList","setBookList","onClickListener","target","push","sortedList","sortList","forEach","document","getElementById","innerText","sort","a","b","localeCompare","onSortListener","reverse","filter","stock"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { useHistory } from \"react-router-dom\";\nimport $ from 'jquery';\nimport PropTypes from 'prop-types';\nimport Button from 'react-bootstrap/Button';\nimport Dropdown from 'react-bootstrap/Dropdown';\nimport './BookList.css';\nimport Book from '../Book/Book';\n\nconst element = new Map()\n\nelement.set(0,\n  {\n    key: 'stocks',\n    header: {\n      label: 'Books available to request',\n      className: 'text-center'\n    },\n    operation: {\n      label: null,\n      className: 'row g-3 align-items-center'\n    }\n  }\n)\nelement.set(1,\n  {\n    key: 'stocks',\n    header: {\n      label: 'Books available to donate',\n      className: 'text-center'\n    },\n    operation: {\n      label: null,\n      className: 'row g-3 align-items-center'\n    }\n  }\n)\nelement.set(2,\n  {\n    key: 'cart.request',\n    header: {\n      label: 'You\\'ve requested the following books',\n      className: 'text-center'\n    },\n    operation: {\n      label: null,\n      className: 'hide'\n    }\n  }\n)\nelement.set(3,\n  {\n    key: 'cart.donate',\n    header: {\n      label: 'You\\'ve donated the following books',\n      className: 'text-center'\n    },\n    operation: {\n      label: null,\n      className: 'hide'\n    }\n  }\n)\n\nfunction BookList({ mode }) {\n\n  const history = useHistory()\n\n  const getInitialStock = () => {\n    if (sessionStorage.getItem(element.get(mode).key) != null)\n      return JSON.parse(sessionStorage.getItem(element.get(mode).key))\n    if (mode < 2) {\n      $.ajax({\n        url: 'https://yrtt-readers.github.io/the-bookclub/assets/data/stocks.json',\n        async: false,\n        dataType: 'json',\n        success: data => {\n          try {\n            sessionStorage.setItem(element.get(mode).key, JSON.stringify(data))\n          } catch (e) { console.log(e) }\n        }\n      })\n      return JSON.parse(sessionStorage.getItem(element.get(mode).key))\n    }\n  }\n\n  const [stocks, setStocks] = useState(getInitialStock)\n  const [sortType, setSortType] = useState('')\n  const [bookList, setBookList] = useState([... new Set(stocks.map(v => { return v.isbn }))])\n\n  if (stocks == null)\n    element.get(mode).header.className = 'hide'\n\n    function onClickListener(e) {\n      if (e.target.className === 'btn btn-primary checkout')\n        history.push('/checkout');\n    }\n  \n    const sortedList = (key) => {\n\n    let sortList = []\n\n    bookList.forEach(v => {sortList.push([v,\n      document.getElementById(v+'.'+key).innerText\n      // JSON.parse(sessionStorage.getItem('book.'+v))[key]\n    ])})\n\n    return [... new Set(sortList\n                      .sort((a,b)=> a[1].localeCompare(b[1]))\n                      // .sort((a,b)=> a[1] - b[1])\n                      .map(v => { return v[0] }))]\n  }\n\n  function onSortListener(e) {\n\n    setSortType(e)\n\n    switch (sortType) {\n      case 'title-AZ':\n        setBookList(sortedList(\"book_name\"))\n        break\n      case 'title-ZA':\n        setBookList(sortedList(\"book_name\").reverse())\n        break\n      case 'author-AZ':\n        setBookList(sortedList(\"book_author\"))\n        break\n      case 'author-ZA':\n        setBookList(sortedList(\"book_author\").reverse())\n        break\n    }\n\n  }\n\n  return (\n\n    <section className='container container-margin'>\n      <div className='row g-3'>\n        <h1 className={element.get(mode).header.className}>{element.get(mode).header.label}</h1>\n      </div>\n      <div className={element.get(mode).operation.className}>\n        <button className='btn btn-primary checkout' onClick={onClickListener}>Checkout</button>\n        <Dropdown className='col-auto' onMouseOut={onSortListener} onSelect={setSortType}>\n          <Dropdown.Toggle variant='primary' id='dropdown-basic-button'>\n            Sort by\n          </Dropdown.Toggle>\n\n          <Dropdown.Menu >\n            <Dropdown.Item eventKey=\"title-AZ\">Title A-Z</Dropdown.Item>\n            <Dropdown.Item eventKey=\"title-ZA\">Title Z-A</Dropdown.Item>\n            <Dropdown.Item eventKey=\"author-AZ\">Author A-Z</Dropdown.Item>\n            <Dropdown.Item eventKey=\"author-ZA\">Author Z-A</Dropdown.Item>\n          </Dropdown.Menu>\n        </Dropdown>\n        <div className='col-auto'>\n          <label htmlFor='inputSearch' className='col-form-label'>Search book</label>\n        </div>\n        <div className='col-auto'>\n          <input\n            type='input'\n            id='inputSearch'\n            className='form-control'\n            aria-describedby='searchHelpInline'\n          />\n        </div>\n\n        <div className='col-auto'>\n          <Button variant='primary'>Search</Button>\n        </div>\n      </div>\n      <div className='row booklist'>\n        {bookList.map(v =>\n          <Book key={v} mode={mode}\n            isbn={v}\n            stocks={stocks.filter(stock => stock.isbn === v)}\n            setStocks={setStocks} />)}\n      </div>\n    </section >\n  );\n}\n\nexport default BookList;\n\nBookList.propTypes = {\n  mode: PropTypes.number\n}"]},"metadata":{},"sourceType":"module"}