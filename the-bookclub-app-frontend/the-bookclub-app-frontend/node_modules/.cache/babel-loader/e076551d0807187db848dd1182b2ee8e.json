{"ast":null,"code":"import _toConsumableArray from\"/Users/winndie/github/the-bookclub/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React from'react';import $ from'jquery';import'./Book.css';var element=new Map();element.set(0,{button:{label:'Request',className:'btn btn-primary request'},storage:{key:'cart.request'},description:{className:'book-description'}});element.set(1,{button:{label:'Donate',className:'btn btn-primary donate'},storage:{key:'cart.donate'},description:{className:'book-description'}});element.set(2,{button:{label:null,className:'hide'},storage:{key:'cart.request'},description:{className:'hide'}});element.set(3,{button:{label:null,className:'hide'},storage:{key:'cart.donate'},description:{className:'hide'}});function Book(_ref){var mode=_ref.mode,isbn=_ref.isbn,stocks=_ref.stocks,setStocks=_ref.setStocks;if(sessionStorage.getItem('book.'+isbn)===null)$.ajax({url:'https://yrtt-readers.github.io/the-bookclub/assets/data/books.json',async:false,success:function success(data){try{sessionStorage.setItem('book.'+isbn,JSON.stringify(data.filter(function(book){return book.isbn===isbn;})[0]));}catch(e){console.log(e);}}});var bookData=JSON.parse(sessionStorage.getItem('book.'+isbn));function onClickListener(e){var item={};var cart=[];if(e.target.className==='btn btn-primary request'){item=stocks.reduce(function(sum,stock){return sum+stock.qty;},0)==0?null:{isbn:isbn,qty:-1};}else if(e.target.className==='btn btn-primary donate'){item={isbn:isbn,qty:+1};}item===null?null:setStocks(function(stock){return[].concat(_toConsumableArray(stock),[item]);});sessionStorage.getItem(element.get(mode).storage.key)===null?sessionStorage.setItem(element.get(mode).storage.key,JSON.stringify(cart)):null;cart=JSON.parse(sessionStorage.getItem(element.get(mode).storage.key));item===null?null:cart.push(item);sessionStorage.setItem(element.get(mode).storage.key,JSON.stringify(cart));}return/*#__PURE__*/_jsxs(\"div\",{className:\"col-lg-4 col-sm-6 book\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"img-thumbnail\",src:bookData.thumbnail,alt:\"book-image-not-found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"book-description\",\"data-testid\":\"book_name\",id:bookData.isbn+'.book_name',children:/*#__PURE__*/_jsx(\"strong\",{children:bookData.book_name})}),/*#__PURE__*/_jsx(\"p\",{className:\"book-description\",\"data-testid\":\"book_author\",id:bookData.isbn+'.book_author',children:/*#__PURE__*/_jsx(\"strong\",{children:bookData.book_author})}),/*#__PURE__*/_jsx(\"p\",{className:element.get(mode).description.className,children:bookData.description}),/*#__PURE__*/_jsxs(\"p\",{className:\"book-description\",children:[\"Book Quantity: \",stocks.reduce(function(sum,stock){return sum+stock.qty;},0)]}),/*#__PURE__*/_jsx(\"p\",{className:\"book-description\",children:\"Post Code\"}),/*#__PURE__*/_jsx(\"p\",{className:\"book-description\",children:/*#__PURE__*/_jsx(\"a\",{href:\"#\",children:\"More info\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:onClickListener,className:element.get(mode).button.className,children:element.get(mode).button.label})]});}export default Book;","map":{"version":3,"sources":["/Users/winndie/github/the-bookclub/src/components/Book/Book.js"],"names":["React","$","element","Map","set","button","label","className","storage","key","description","Book","mode","isbn","stocks","setStocks","sessionStorage","getItem","ajax","url","async","success","data","setItem","JSON","stringify","filter","book","e","console","log","bookData","parse","onClickListener","item","cart","target","reduce","sum","stock","qty","get","push","thumbnail","book_name","book_author"],"mappings":"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","sourcesContent":["import PropTypes from 'prop-types';\nimport React from 'react';\nimport $ from 'jquery';\nimport './Book.css';\n\nconst element = new Map()\nelement.set(0,\n  {\n    button: {\n      label: 'Request',\n      className: 'btn btn-primary request'\n    },\n    storage: {\n      key: 'cart.request'\n    },\n    description: {\n      className: 'book-description'\n    }\n  }\n)\nelement.set(1,\n  {\n    button: {\n      label: 'Donate',\n      className: 'btn btn-primary donate'\n    },\n    storage: {\n      key: 'cart.donate'\n    },\n    description: {\n      className: 'book-description'\n    }\n  }\n)\nelement.set(2,\n  {\n    button: {\n      label: null,\n      className: 'hide'\n    },\n    storage: {\n      key: 'cart.request'\n    },\n    description: {\n      className: 'hide'\n    }\n  }\n)\nelement.set(3,\n  {\n    button: {\n      label: null,\n      className: 'hide'\n    },\n    storage: {\n      key: 'cart.donate'\n    },\n    description: {\n      className: 'hide'\n    }\n  }\n)\nfunction Book({ mode, isbn, stocks, setStocks }) {\n\n  if (sessionStorage.getItem('book.' + isbn) === null)\n    $.ajax({\n      url: 'https://yrtt-readers.github.io/the-bookclub/assets/data/books.json',\n      async: false,\n      success: data => {\n        try {\n          sessionStorage\n            .setItem('book.' + isbn,\n              JSON.stringify(data.filter(book => book.isbn === isbn)[0]))\n        } catch (e) { console.log(e) }\n      }\n    })\n\n  const bookData = JSON.parse(sessionStorage.getItem('book.' + isbn))\n\n  function onClickListener(e) {\n\n    let item = {}\n    let cart = []\n\n    if (e.target.className === 'btn btn-primary request') {\n      item =\n        stocks.reduce((sum, stock) => sum + stock.qty, 0) == 0 ?\n          null : { isbn: isbn, qty: -1 }\n    }\n    else if (e.target.className === 'btn btn-primary donate') {\n      item = { isbn: isbn, qty: +1 }\n    }\n\n    item === null ? null :\n      setStocks(stock => [...stock, item])\n\n    sessionStorage.getItem(element.get(mode).storage.key) === null ?\n      sessionStorage.setItem(element.get(mode).storage.key, JSON.stringify(cart)) : null\n\n    cart = JSON.parse(sessionStorage.getItem(element.get(mode).storage.key))\n\n    item === null ? null :\n      cart.push(item)\n\n    sessionStorage.setItem(element.get(mode).storage.key,\n      JSON.stringify(cart))\n\n  }\n\n  return (\n    <div className='col-lg-4 col-sm-6 book'>\n      <img\n        className='img-thumbnail'\n        src={bookData.thumbnail}\n        alt='book-image-not-found'\n      />\n      <p className='book-description' data-testid='book_name' id={bookData.isbn+'.book_name'}>\n        <strong>{bookData.book_name}</strong>\n      </p>\n      <p className='book-description' data-testid='book_author' id={bookData.isbn+'.book_author'}>\n        <strong>{bookData.book_author}</strong>\n      </p>\n      <p className={element.get(mode).description.className}>{bookData.description}</p>\n      <p className='book-description'>Book Quantity: {stocks.reduce((sum, stock) => sum + stock.qty, 0)}\n      </p>\n      <p className='book-description'>Post Code</p>\n      <p className='book-description'>\n        <a href='#'>More info</a>\n      </p>\n      <button onClick={onClickListener}\n        className={element.get(mode).button.className}>\n        {element.get(mode).button.label}\n      </button>\n    </div>\n  )\n\n}\n\nBook.propTypes = {\n  mode: PropTypes.number,\n  isbn: PropTypes.number,\n  stocks: PropTypes.array,\n  setStocks: PropTypes.func,\n};\n\nexport default Book;\n"]},"metadata":{},"sourceType":"module"}